<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CRUD</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <script>
        var cursos = [];

        class Curso {
            constructor(curso, categoria, valor) {
                this.curso = curso;
                this.categoria = categoria;
                this.valor = valor;
            }
        }

        //cadastro de cursos
        cadastrar = () => {
            var curso = document.getElementById("campo_curso").value;
            var categoria = document.getElementById("campo_categoria").value;
            var valor = document.getElementById("campo_valor").value;

            const obj = new Curso(curso, categoria, valor);

            cursos.push(obj);
            
            bancoLocal();
            listar();

            console.log(cursos);
        }

        //listagem de cursos
        listar = () => {
            var tabela = document.getElementById("tabela");

            tabela.innerHTML = "";

            for (let i = 0; i < cursos.length; i++) {
                var linha = tabela.insertRow(-1);

                var coluna1 = linha.insertCell(0);
                var coluna2 = linha.insertCell(1);
                var coluna3 = linha.insertCell(2);
                var coluna4 = linha.insertCell(3);
                var coluna5 = linha.insertCell(4);

                coluna1.innerHTML = i + 1;
                coluna2.innerHTML = cursos[i].curso;
                coluna3.innerHTML = cursos[i].categoria;
                coluna4.innerHTML = cursos[i].valor;
                coluna5.innerHTML = "<button class='btn' onClick='remover(" + i + ")'>Remover</button>";



            }
        }

        //excluir cursos
        remover = (i) => {
            cursos.splice(i, 1);

            bancoLocal();

            listar();
        }

        //LocalStorage
        bancoLocal = () => {
            localStorage.removeItem("cursos_local");
            localStorage.setItem("cursos_local", JSON.stringify(cursos));
        }

        //verificar cursos sakvos localmente
        verificarBancoLocal = () => {
            if(localStorage.getItem("cursos_local") != null){
                var temp = JSON.parse(localStorage.getItem("cursos_local"));

                for(var indice=0; indice<temp.length; indice++){
                    var obj = new Curso(temp[indice].curso, temp[indice].categoria, temp[indice].valor);
                    cursos.push(obj);
                }

                listar();
            }
        }


        window.onload = function () {
            verificarBancoLocal();
            document.getElementById("botao_cadastrar").addEventListener("click", cadastrar);
        }

    </script>
    <!--onsen pra angula e zoror-->
</head>

<body>
    <!--regex-->
    <div class="row">
        <div class="col s8 offset-s2">
            <input type="text" id="campo_curso">
            <label>Curso</label>

            <input type="text" id="campo_categoria">
            <label>Categoria</label>

            <input type="text" id="campo_valor">
            <label>Valor</label>

            <br>
            <button class="btn" style="margin-top: 20px;" id="botao_cadastrar">Cadastrar</button>
        </div>
    </div>
    <table>
        <thead>
            <tr>
                <th>CÃ³digo</th>
                <th>Curso</th>
                <th>Categoria</th>
                <th>Valor</th>
                <th>Remover</th>
            </tr>
        </thead>
        <tbody id="tabela"></tbody>
    </table>

</body>

</html>